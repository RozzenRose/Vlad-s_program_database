#docker 

![[Pasted image 20250506172419.png]]
Образ **Docker** - это неизменяемый шаблон, используемый для создания контейнеров **Docker**. Он представляет собой набор слоев (**layers**) с файлами и метаданными, необходимыми для запуска приложения. Можно представить его как "снимок" файловой системы, включающей все необходимые компоненты приложения.
#### Устройство образа:
Образ **Docker** - это неизменяемый шаблон, используемый для создания контейнеров **Docker**. Он представляет собой набор слоев, организованных в иерархическую структуру. Каждый такой слой содержит изменения по отношению к предыдущему слою. Это ключевая особенность **Docker**, обеспечивающая эффективное хранение и переиспользование компонентов.
- **Базовый слой (Base Layer):** Это самый нижний слой, основа образа. Обычно это базовая операционная система (например, Ubuntu, Alpine). Изменения в этом слое редки и затрагивают саму базовую систему.
- **Промежуточные слои (Intermediate Layers):** Каждая команда в  `Dockerfile` создает новый слой. Например, установка пакета  `apt-get install <package>` создает слой, содержащий установленный пакет. Команды копирования файлов (`COPY`,  `ADD`) также создают новые слои. Это позволяет Docker эффективно использовать пространство на диске, так как изменения в образе хранятся в виде разностных файлов (deltas).
- **Верхний слой (Top Layer):** Это самый верхний слой, содержащий конкретные данные приложения (код, конфигурационные файлы и т.д.). Этот слой чаще всего изменяется при обновлении приложения.
![[Pasted image 20250506174244.png]]
Когда вы запускаете контейнер, **Docker** создает **union** файловой системы, объединяя все слои. При изменении данных в контейнере, изменения не вносятся в основные слои. Вместо этого, они сохраняются в верхнем слое. Это позволяет **Docker** быстро создавать и удалять контейнеры, так как только верхний слой нуждается в изменениях. Когда контейнер удаляется, только верхний слой исчезает, базовые слои остаются нетронутыми и могут быть использованы для создания новых контейнеров.

---
### Архитектура и компоненты Docker
Архитектура **Docker** основана на клиент-серверной модели и включает несколько ключевых компонентов:

**1. Docker Deamon (Сервер)**:
Это основной процесс Docker, который выполняется в фоновом режиме на хост-машине. Он отвечает за управление образами, контейнерами, сетями и хранилищем. Он слушает запросы от Docker Client и выполняет все действия, связанные с управлением контейнерами.

**2. Docker Client (Клиент)**:
Это интерфейс командной строки (CLI) или API, который используется для взаимодействия с Docker Daemon. Пользователь использует Docker Client для отправки команд (например, `docker run`, `docker build`, `docker ps`), которые затем передаются Docker Daemon для выполнения. Docker Client может работать на той же машине, что и Daemon, или на удалённой машине.

**3. Docker Images (Образы):**
Это неизменяемые шаблоны, используемые для создания контейнеров. Они содержат все необходимые файлы и инструкции для запуска приложения. Образы состоят из слоев (layers), что позволяет Docker эффективно использовать дисковое пространство и кэшировать части образов.

**4. Docker Containers (Контейнеры):**
Это экземпляры Docker Images. Они являются изолированными средами для запуска приложений. Каждый контейнер имеет свою собственную файловую систему, процессы, сеть и т.д., но они делят ядро операционной системы хоста.

**5. Docker Registry (Реестр):**
Это централизованное хранилище для Docker Images. Docker Hub является наиболее популярным публичным реестром, но вы также можете создавать и использовать свои собственные частные реестры. Реестры позволяют хранить, управлять и распространять образы Docker.

**6. Docker Hub:**
Это публичный реестр Docker, предоставляемый Docker Inc. Он содержит огромное количество готовых образов, которые можно использовать для создания контейнеров.
![[Pasted image 20250506185927.png]]