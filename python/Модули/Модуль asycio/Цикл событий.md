#модуль #python #asyncio #асинхронное_программирование #event_loop #get_event_loop #run_until_complete #run

Цикл событий - это механизм, который управляет выполнением асинхронных задач. В `ascyncio` цикл событий предоставляется автоматически, но мы можем создать и управлять им вручную
##### Простейший цикл событий
Начнем с создания простейшего цикла событий, который будет выполнять одну асинхронную задачу. Асинхронные функции объявляются с помощью ключевого слова `ascync`  и выполняются с помощью `await`
##### Пример простого цикла событий
```python
import asyncio

async def simple_task():
    print("Начало выполнения задачи")
    await asyncio.sleep(1)
    print("Задача завершена")

try:
    # Создаем цикл событий
    loop = asyncio.get_event_loop()
    # Запускаем задачу и передаем ее в цикл событий
    loop.run_until_complete(simple_task())

finally:
    # Закрываем цикл событий
    loop.close()
```
```
Начало выполнения задачи
Задача завершена
```
Пошаговое объяснение:
1. **Импорт библиотеки** `asyncio`: `asyncio` — это встроенная библиотека Python для поддержки асинхронного программирования.
2. **Создание асинхронной функции** `simple_task`: Эта функция выводит сообщение, ждет 1 секунду и выводит еще одно сообщение. Функция `await asyncio.sleep(1)` приостанавливает выполнение функции на 1 секунду, что позволяет другим задачам выполняться в это время.
3. **Создание цикла событий**: `asyncio.get_event_loop()` создает или получает текущий цикл событий.
4. **Запуск задачи**: `loop.run_until_complete(simple_task())` запускает асинхронную задачу и блокирует выполнение до ее завершения.
5. **Закрытие цикла событий**: После завершения всех задач цикл событий закрывается с помощью `loop.close()`.
##### Управление несколькими задачами
Цикл событий позволяет конкурентно выполнять несколько задач. Давайте создадим пример, где мы запускаем несколько задач конкурентно:
```python
import asyncio

async def task1():
    print("Начало выполнения 1ой задачи")
    await asyncio.sleep(2)
    print("Задача 1 завершена")

async def task2():
    print("Начало выполнения 2ой задачи")
    await asyncio.sleep(1)
    print("Задача 2 завершена")

async def main():
    await asyncio.gather(task1(), task2())

# Создаем и запускаем цикл событий
try:
    loop = asyncio.get_event_loop()
    loop.run_until_complete(main())
finally:
    loop.close()
```
```
Начало выполнения 1ой задачи
Начало выполнения 2ой задачи
Задача 2 завершена
Задача 1 завершена
```
Пошаговое объяснение:
1. **Создание нескольких асинхронных функций**: `task1` и `task2` выполняют различные задачи и используют `await asyncio.sleep()` для приостановки выполнения
2. **Создание функции** `main`: Функция `main` использует `asyncio.gather()` для выполнения нескольких задач параллельно.
3. **Запуск цикла событий**: Цикл событий запускается с задачами, переданными в `main`.
### [[asyncio.run()]] - обертка для автоматического создания, запуска и остановки циклов событий