#FastAPI 

![[Pasted image 20250403135556.png]]
### Простая структура (для маленьких проектов)
Простая структура подходит для небольших приложений с ограниченным количеством эндпоинтов. Все файлы находятся в одном каталоге:
```
myproject/
├── main.py        # Основной файл приложения
└── models.py     # Модели данных (Pydantic)
```
- `main.py`: Содержит код создания приложения FastAPI и определение маршрутов (endpoints).
- `models.py`: Определяет модели данных с помощью Pydantic.
### Структура по функциональным областям
Для более крупных проектов лучше разделить код по функциональным областям
```
myproject/
├── main.py        # Основной файл приложения
├── users/         # Модуль, отвечающий за пользователей
│   ├── __init__.py
│   ├── routes.py   # Маршруты, связанные с пользователями
│   ├── models.py  # Модели пользователей (Pydantic)
│   └── services.py # Бизнес-логика для пользователей
├── products/      # Модуль, отвечающий за продукты
│   ├── __init__.py
│   ├── routes.py
│   ├── models.py
│   └── services.py
└── database.py   # Подключение к базе данных
```
В этом примере:
- Каждый подкаталог (`users`,  `products`) содержит код, связанный с конкретной функциональной областью.
- `routes.py`: Определяет маршруты FastAPI для данной функциональной области.
- `models.py`: Определяет модели Pydantic для данных.
- `services.py`: Содержит бизнес-логику, не связанную непосредственно с FastAPI.
- `database.py`: Содержит функции для взаимодействия с базой данных.
### Расширенная структура с использованием слоев:
Для очень больших и сложных проектов рекомендуется использовать слоистую архитектуру, чтобы обеспечить лучшую организацию кода и повысить его поддерживаемость.
```
myproject/
├── main.py        # Основной файл приложения
├── api/           # API слой (FastAPI)
│   ├── __init__.py
│   └── routes.py
├── application/   # Прикладной слой (бизнес-логика)
│   ├── __init__.py
│   ├── users/
│   │   └── services.py
│   └── products/
│       └── services.py
├── infrastructure/ # Инфраструктурный слой (взаимодействие с внешними системами)
│   ├── __init__.py
│   ├── database.py
│   └── external_api.py
└── models/         # Модели данных (Pydantic)
    ├── __init__.py
    ├── user.py
    └── product.py
```
В этом примере:
- `api`: Содержит только код FastAPI и определяет маршруты.
- `application`: Содержит бизнес-логику приложения.
- `infrastructure`: Взаимодействие с базой данных, внешними API и другими внешними системами.
- `models`: Определяет модели Pydantic.

Также рассмотрим подобную структуру. Приложение состоит из четырех пакетов, которые предлагают функциональность, связанную с обслуживанием: маршрутизаторы, сервисы, схемы и модели. Чтобы внедрить новый функционал, необходимо добавить новый модуль в каждый из этих пакетов.
```
    .
    └── app/
        ├── backend/          # Функциональность и конфигурации бэкэнда
        |   ├── config.py         # Настройки конфигурации
        │   └── session.py        # Менеджер сеансов базы данных
        ├── models/           # SQLAlchemy модели
        │   ├── user.py           # Модель пользователя
        |   ├── products.py       # Модель товара
        |   └── ...             
        ├── routers/          # API пути
        |   ├── auth.py           # Авторизация
        │   └── ...                
        ├── schemas/          # Pydantic модели
        |   ├── auth.py              
        │   └── ...
        ├── services/         # Различная бизнес логика
        |   ├── auth.py           # Создание пользователя, генерация и проверка токенов
        |   ├── base.py           # Базовые классы, миксины
        │   └── ...
        └── main.py           # Основной файл приложения
```
В этой структуре папка маршрутизаторов (`routers`) служит уровнем взаимодействия пользовательского интерфейса (**UI**)

`models` предоставляет сопоставления **SQLAlchemy**, которые устанавливают взаимосвязь между объектами базы данных и классами **Python**, в то время как `schemas` представляет сериализованные модели данных (**Pydantic** модели), которые используются во всем приложении в качестве объектов ответа.

Папка `backend` предоставляет менеджер базы данных и класс конфигурации приложения. В сценариях, когда приложение взаимодействует не только с базой данных, но и другими бэкендами, такими как дополнительные **API**, соответствующие файлы могут быть  размещены в пакете `beckend`.

Основной модуль `main.py` предоставляет точку входа **FastAPI** и инициирует объект приложения (экземпляр класса **FastAPI**)