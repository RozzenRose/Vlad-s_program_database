#FastAPI 

Функция **Depends** отвечает за внедрения зависимостей в приложениях **FastAPI**, которые позволяют вам добавить зависимости к **API** - методу. Это означает, что выполнение этого метода зависимости от выполнения другой функции или условия.

Преимущества этого подхода:
- **Разделение функционала:** Мы можем сосредоточиться на бизнес-логике, а не на создании дополнительных общих объектов. Например, если есть эндпоинт, который принимает данные формы контакта и отправляет электронное письмо. Мы можем разделить часть настройки почтового клиента.
- **Общая логика:** Мы можем извлечь общую логику. Общий фрагмент кода может быть объявлен один раз и на него можно ссылаться снова и снова. Например, в API сервисах, очень часто работают с базами данных, с помощью которых получают или обновляют информацию. Для этих задач нам нужен сеанс базы данных. Если мы напишем код, где будем получать сеанс базы данных для каждого эндпоинта, то это загромоздит наш код. Вместо этого мы можем извлечь эту часть и просто ссылаться на нее в каждом эндпоинте.
- **Тестирование:** FastAPI позволяет очень легко переопределять зависимости во время тестирования. Это помогает нам избежать ненужного исправления кода.

### Внедрение функции зависимости
Создадим новый проект.
Работать мы будем в файле `main.py`, добавим в него несколько эндпоинтов.
```python
from fastapi import FastAPI, Depends

app = FastAPI()


@app.get("/messages")
async def all_messages(limit: int = 10, page: int = 1):
    return {"messages": [{'limit': limit, 'page': page}]}


@app.get("/comments")
async def all_comments(limit: int = 10, page: int = 1):
    return {"comments": [{'limit': limit, 'page': page}]}
```
Как мы видим, они получают одни и те же параметры - `limit`, это количество записей на страницу и `page`, это номер страницы. Например, используя пагинацию, первый эндпоинт будет выводить все сообщения из нашей ДБ, а второй будет выводить все комментарии. Мы эту логику не будем реализовывать, основная цель статьи показать как мы можем использовать зависимости.

Запустим сервер командой `uvicorn main:app --port 8000` и проверим работу перейдя в документацию:
![[Pasted image 20250401175033.png]]Если внимательно посмотреть на код, то становится понятно, что у нас есть дублирование кода в плане параметров, которые получают наши эндпоинты. И также если у нас будет большой проект, то нам будет не удобно редактировать эти параметры по умолчанию или вносить различные изменения.
### [[Зависимости на основе функций]]
### [[Зависимость на основе классов]]
### [[Использование вложенных зависимостей]]