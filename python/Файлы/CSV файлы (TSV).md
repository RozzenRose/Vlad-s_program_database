#файлы #работа_с_файлами #python #CSV #TSV

Текстовый формат, предназначенный для представления табличных данных. Строка таблицы соответствует строке текста, которая содержит одно или несколько полей, разделенных запятыми.

Например эта таблица:

|Rank|Language|Share|
|---|---|---|
|1|Python|31.17%|
|2|Java|17.75%|
|3|JavaScript|8%|
|4|C#|7.05%|
|5|PHP|6.09%|
в  `CSV` будет выглядеть так:
```CSV
Rank,Language,Share
1,Python,31.17%
2,Java,17.75%
3,JavaScript,8%
4,C#,7.05%
5,PHP,6.09%
```

На практике, если ты не лох, будешь для работы с `CSV` юзать [[Модуль CSV]], если лох, тогда руками
### Работа с CSV файлами руками 

Для работы с такими файлами имеет смысл определить два типа `разделителей`:
`межячеечный` - разделитель, который отделяет одну ячейку от другой в рамках одной строки
`межстрочечеый` - разделитель, который отделяет одну строку от другой

По дефолту в CSV `межячеечеый` разделитель это `','` а `межстрочечный` `'\n'`

Можно упаковать это все в экземпляр объекта `list`, заполненный другими объектами типа `list`, в котором каждый внутренний `list` будет содержать набор элементов из ячеек одной строки. Так просто удобнее всего работать с таблицами.
```python
with open('products.csv', encoding='utf-8') as file:
    data = file.read()
    for line in data.splitlines(): #делим весь файл на строки межстрочечным разделителем
        print(line.split(',')) #делим строки на ячейки межячеечным разделителем
```
```CSV
['Rank','Language','Share']
['1','Python','31.17%']
['2','Java','17.75%']
['3','JavaScript','8%']
['4','C#','7.05%']
['5',PHP',6.09%']
```
Метод `splitlines()` вернет `list`, заполненный строками исходного файла, мы закидываем его в цикл и в цикле делим эти строки на элементы

Метод `splitlines()` это строчечный метод, который возвращает на основе строки `list`, который будет заполнен строковыми объектами, разделенными по элементу `'\n'`
`splitlines() = slit('\n')`

Еще мы можем использовать вложенный список:
```python
with open('products.csv', encoding='utf-8') as file:
    data = file.read()
    table = [item.split(',') for item in data.splitlines()]
```
Весь считанный файл мы делим методом `splitlines()` на строки, а потом делим каждую строку методом `split()` на ячейки.
А итоге объект `table` содержит список со списками, где каждый внутренний список содержит ячейки одной строки.

Вообще, формат `CSV` предполагает, что первая строка содержит заголовки для столбцов, так что после преобразования такого файла в табличку в виде списка со спискам для дальнейшей работы имеет смысл снести нулевой внутренний список, потому что он будет содержать заголовки.
```python
del table[0]
```

Мы можем попасть в ситуацию, когда `','` вообще то является частью строки, и она не должна инициировать разделение строки на ячейки. Для избегания таких ситуаций применяется несколько `проходов`.

#### Подход 1
 Данные должны быть упакованы через `" "`. Если этого не сделать данные просто невозможно будет корректно считать без гемороя.
```
keywords,price,product_name
"Садовый стул, стул для дачи",1699,ВЭДДО
Садовый стул,2999,ЭПЛАРО
Садовый табурет,1699,ЭПЛАРО
Садовый стол,1999,ТЭРНО
"Складной стол, обеденный стол",7499,ЭПЛАРО
Настил,1299,РУННЕН
Стеллаж,1299,ХИЛЛИС
"Кружка, сосуд, стакан с ручкой",39,СТЕЛЬНА
Молочник,299,ВАРДАГЕН
Термос для еды,699,ЭФТЕРФРОГАД
Ситечко,59,ИДЕАЛИСК
Чайник заварочный,499,РИКЛИГ
Кофе-пресс,699,УПХЕТТА
Чашка с блюдцем,249,ИКЕА
"Кружка, стакан с ручкой",249,ЭМНТ
Ситечко,199,САККУННИГ
Кружка,199,ФИНСТИЛТ
"Тарелка, блюдце",269,ЭВЕРЕНС
```

#### Подход 2
Использовать в качестве разделителя другой символ, например, символ табуляции `\t`, который очень редко встречается в качестве валидной части текста.
```
keywords	price	product_name
Садовый стул, стул для дачи	1699	ВЭДДО
Садовый стул	2999	ЭПЛАРО
Садовый табурет	1699	ЭПЛАРО
Садовый стол	1999	ТЭРНО
Складной стол, обеденный стол	7499	ЭПЛАРО
Настил	1299	РУННЕН
Стеллаж	1299	ХИЛЛИС
Кружка, сосуд, стакан с ручкой	39	СТЕЛЬНА
Молочник	299	ВАРДАГЕН
Термос для еды	699	ЭФТЕРФРОГАД
Ситечко	59	ИДЕАЛИСК
Чайник заварочный	499	РИКЛИГ
Кофе-пресс	699	УПХЕТТА
Чашка с блюдцем	249	ИКЕА
Кружка, стакан с ручкой	249	ЭМНТ
Ситечко	199	САККУННИГ
Кружка	199	ФИНСТИЛТ
Тарелка, блюдце	269	ЭВЕРЕНС
```
`CSV` в котором разделителем является символ табуляции, называют `TSV`

