#база_данных #реляционные #SQL #СУБД #CONVERT #CAST 

Во время выполнения операций со значениями разных типов происходит автоматическое приведение этих значений к одному типу. Например, при попытке сложить число и строку СУБД сначала конвертирует прибавляемую строку в число.
```MySQL
SELECT 1 + '15';
```
```
+----------+
| 1 + '15' |
+----------+
| 16.0     |
+----------+
```
Однако не всегда СУБД может автоматически привести используемые значения к нужному типу для корректного выполнения операции, поэтому иногда это приходится делать вручную. В SQL для преобразования типов используются функции `CONVERT()` и `CAST()`.

Функция `CONVERT()` принимает два аргумента в следующем порядке:
- `value` — значение, которое необходимо преобразовать
- `type` — желаемый тип

Функция приводит значение `value` к типу `type` и возвращает полученный результат.
```MySQL
SELECT CONVERT(100.78, DECIMAL(4, 1)),
       CONVERT(100.78, DECIMAL(3, 0));
```
```
+--------------------------------+--------------------------------+
| CONVERT(100.78, DECIMAL(4, 1)) | CONVERT(100.78, DECIMAL(3, 0)) |
+--------------------------------+--------------------------------+
| 100.8                          | 101                            |
+--------------------------------+--------------------------------+
```
Функция `CONVERT()` умеет приводить значение к следующим типам:

| **Тип**         | **Описание**                           |
| --------------- | -------------------------------------- |
| `DATE`          | значение типа `DATE`                   |
| `DATETIME`      | значение типа `DATETIME`               |
| `TIME`          | значение типа `TIME`                   |
| `DECIMAL(M, D)` | значение типа `DECIMAL`                |
| `CHAR(N)`       | значение типа `CHAR`                   |
| `BINARY`        | значение типа `BINARY`                 |
| `SIGNED`        | значение типа `BIGINT` с учетом знака  |
| `UNSIGNED`      | значение типа `BIGINT` без учета знака |
| `YEAR`          | значение типа `YEAR`                   |

Значение, приводимое к определенному типу, должно соответствовать формату этого типа, в противном случае функция `CONVERT()` вернет значение `NULL`. 
```MySQL
SELECT CONVERT('2023-01-01', DATE),
       CONVERT('beegeek', DATE);
```
```
+-----------------------------+--------------------------+
| CONVERT('2023-01-01', DATE) | CONVERT('beegeek', DATE) |
+-----------------------------+--------------------------+
| 2023-01-01                  | NULL                     |
+-----------------------------+--------------------------+
```

Однако при попытке привести несоответствующее формату значение к числовому типу функция `CONVERT()` вернет значение `0`.
```MySQL
SELECT CONVERT('beegeek', SIGNED),
       CONVERT('beegeek', UNSIGNED),
       CONVERT('beegeek', DECIMAL(5, 2));
```
```
+----------------------------+------------------------------+-----------------------------------+
| CONVERT('beegeek', SIGNED) | CONVERT('beegeek', UNSIGNED) | CONVERT('beegeek', DECIMAL(5, 2)) |
+----------------------------+------------------------------+-----------------------------------+
| 0                          | 0                            | 0.00                              |
+----------------------------+------------------------------+-----------------------------------+
```

Похожим образом себя ведет функция `CAST()` за тем исключением, что она разделяет передаваемые аргументы не запятой, а ключевым словом `AS`.
```MySQL
SELECT CAST(100.78 AS DECIMAL(4, 1)),
       CAST(100.78 AS DECIMAL(3, 0));
```
```
+-------------------------------+-------------------------------+
| CAST(100.78 AS DECIMAL(4, 1)) | CAST(100.78 AS DECIMAL(3, 0)) |
+-------------------------------+-------------------------------+
| 100.8                         | 101                           |
+-------------------------------+-------------------------------+
```

### В `PostgreSQL` нет функции `CONVERT()`, но есть функция `CAST()`
Так же в `PostgreSQL` есть специальный оператор `::`
```PostgreSQL
SELECT '123'::INTEGER AS integer_value;
```