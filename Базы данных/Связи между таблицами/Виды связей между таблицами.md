#база_данных #реляционные #SQL #СУБД 

Сочетание первичных и внешних ключей позволяет установить связь между таблицами, однако эта связь не всегда имеет один и тот же вид. Выделяют три вида связей между таблицами: **"один к одному"**, **"один ко многим"** и **"многие ко многим​**​​​​​​".
### Связь **один к одному**
Связь "**один к одному**" предполагает, что каждая запись в одной таблице связана с одной записью в другой таблице. Это означает, что одна запись в первой таблице имеет только одну соответствующую ей запись во второй таблице и наоборот

В качестве примера установления этого вида связи рассмотрим базу данных, которая хранит персональные данные различных людей и их паспортные данные

Персональные данные людей располагаются в таблице **Люди**, которая имеет следующий вид:

| **ID** | **Имя и фамилия** | **Номер паспорта** |
| ------ | ----------------- | ------------------ |
| 1      | Билл Гейтс        | 548491             |
| 2      | Алан Тьюринг      | 121685             |
| 3      | Эдгар Кодд        | 144789             |
Паспортные данные людей располагаются в таблице **Паспортные данные**, которая имеет следующий вид:

| **Номер паспорта** | **Дата выдачи** | **Гражданство** |
| ------------------ | --------------- | --------------- |
| 121685             | 1940-06-23      | Великобритания  |
| 144789             | 1970-03-15      | Великобритания  |
| 548491             | 2005-08-10      | США             |
Номер паспорта каждого человека уникален, поэтому после `Номер паспорта` в таблице `Паспортные данные` используются в качестве первичного ключа. В таблице `Люди` после `Номер паспорта` выступает в качестве внешнего ключа и ссылается на первичный ключ таблицы `Паспортные данные` - поле `Номер паспорта`.

В обеих таблицах после `Номер паспорта` содержит уникальные значения. Следовательно, какую бы запись из таблицы `Люди` мы ни взяли, в соответствие ей мы сможем поставить только одну запись из таблицы `Паспортные данные`. Справедливо и обратное: какую бы запись из таблицы `Паспортные данные` мы ни взяли. в соответствие ей мы сможем поставить только одну запись из таблицы `Люди` 

Например, первой записb из таблицы `Люди` соответствует третья запись из таблицы `Паспортные данные` и никакая другая. То же самое наоборот: третья запись из таблицы `Паспортные данные` соответствует первая запись из таблицы `Люди` и никакая другая. Подобная связь и соответствует связи **один к одному**

На схеме данных связь **один к одному** обычно обозначается линией, с обеих концов посеченной одной черточкой. Например, для таблиц `Люди` и `Паспортные данные` схема данных будет иметь следующий вид:
![[Pasted image 20241213154318.png]]
### Связь **одни ко многим**
Связь "один ко многим" предполагает, что одна запись в одной таблице связана с несколькими записями в другой таблице. Это означает, что у одной записи в первой таблице может быть несколько соответствующих ей записей во второй таблице, но каждая запись во второй таблице может быть связана только с одной записью в первой таблице.

В качестве примера установления этого вида связи рассмотрим предложенную в начале урока базу данных некоторого интернет-магазина, которая хранит персональные данные покупателей и информацию об их заказах.

Персональные данные покупателей располагаются в таблице `Покупатели`, которая имеет следующий вид:

| **ID** | **Имя и фамилия** |
| ------ | ----------------- |
| 1      | Билл Гейтс        |
| 2      | Алан Тьюринг      |

Информация о заказах покупателей располагается в таблице `Заказы`, которая имеет следующий вид:

| **ID** | **ID покупателя** | **Стоимость** |
| ------ | ----------------- | ------------- |
| 1      | 2                 | 1500          |
| 2      | 1                 | 1000          |
| 3      | 2                 | 3500          |

Напомним, что в обеих таблицах поле `ID` является первичным ключом, а поле `ID покупателя` таблицы `Заказы` является внешним ключом, который ссылается на первичный ключ таблицы `Покупатели` — поле `ID`.

В интернет-магазине один покупатель может совершить как один заказ, так и несколько. Следовательно, одной записи из таблицы `Покупатели` мы также можем поставить в соответствие одну или несколько записей из таблицы `Заказы`. Например, второй записи из таблицы `Покупатели` соответствуют две записи из таблицы `Заказы`: первая и третья.

В то же время один и тот же заказ не может быть совершен несколькими покупателями. Следовательно, какую бы запись из таблицы `Заказы` мы ни взяли, в соответствие ей мы сможем поставить только одну запись из таблицы `Покупатели`. Например, третьей записи из таблицы `Заказы` соответствует только вторая запись из таблицы `Покупатели`. Подобная связь и соответствует связи "один ко многим".

На схеме данных связь "один ко многим" обычно обозначается линией, с одного конца помеченной одной черточкой, с другой — тремя черточками. Например, для таблиц `Покупатели` и `Заказы` схема данных будет иметь следующий вид:
![[Pasted image 20241213154434.png]]
### Связь **многие к многим**
Связь "многие ко многим" предполагает, что несколько записей в одной таблице могут быть связаны с несколькими записями в другой таблице. Это означает, что у одной записи в первой таблице может быть множество соответствующих записей во второй таблице, и наоборот.

В качестве примера установления этого вида связи рассмотрим базу данных некоторого вуза, которая хранит персональные данные студентов, информацию о преподаваемых в вузе предметах, а также информацию о том, какие предметы изучает каждый студент.

Персональные данные студентов располагаются в таблице `Студенты`, которая имеет следующий вид:

| **ID** | **Имя и фамилия** |
| ------ | ----------------- |
| 1      | Билл Гейтс        |
| 2      | Алан Тьюринг      |

Информация о преподаваемых предметах располагается в таблице `Предметы`, которая имеет следующий вид:

| **ID** | **Название** |
| ------ | ------------ |
| 1      | Математика   |
| 2      | Физика       |
| 3      | Химия        |

Информация об изучаемых студентами предметах располагается в таблице `Изучаемые предметы`, которая имеет следующий вид:

| **ID студента** | **ID предмета** |
| --------------- | --------------- |
| 1               | 2               |
| 1               | 3               |
| 2               | 1               |
| 2               | 2               |

Таблица `Изучаемые предметы` состоит из двух внешних ключей, первый из которых ссылается на первичный ключ таблицы `Студенты` (поле `ID`), второй — таблицы `Предметы` (поле `ID`). Например, первая запись таблицы `Изучаемые предметы` говорит о том, что студент с идентификатором `1` изучает предмет с идентификатором `2`, что соответствует тому, что Билл Гейтс изучает физику.

Каждый студент вуза может изучать несколько предметов, при этом каждый предмет также может изучаться несколькими студентами. Таким образом, выбрав группу студентов, мы можем получить группу предметов, которые они изучают. И наоборот: выбрав группу предметов, мы можем получить группу студентов, которые изучают выбранные предметы. Подобная связь и соответствует связи "многие ко многим".

Особенностью связи "многие ко многим" является то, что она не устанавливается между двумя таблицами напрямую, а требует использования вспомогательной промежуточной таблицы. В нашем случае для установления такой связи между таблицами `Студенты` и `Предметы` используется таблица `Изучаемые предметы`.

Фактически, связь "многие ко многим" осуществляется с помощью двух связей "один ко многим". В нашем примере связь "один ко многим" присутствует между таблицами `Студенты` и `Изучаемые предметы`, а также между таблицами `Предметы` и `Изучаемые предметы`. Поэтому схема данных для таблиц `Студенты, Предметы` и `Изучаемые предметы` будет иметь следующий вид:
![[Pasted image 20241213154612.png]]