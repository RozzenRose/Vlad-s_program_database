#база_данных #реляционные #SQL #СУБД 

Основной идеей реляционной модели хранения данных является разбиение информации по тематическим таблицам и установление связей между этими таблицами с помощью первичных и внешних ключей. Такие связи позволяют избежать избыточности информации, а также обеспечивают структурированный способ хранения данных и их целостность.

В качестве простого примера установления связи между таблицами рассмотрим базу данных некоторого интернет-магазина, которая хранит персональные данные покупателей и информацию об их заказах.

Персональные данные покупателей располагаются в таблице `Покупатели`, которая имеет следующий вид:

| **ID** | **Имя и фамилия** |
| ------ | ----------------- |
| 1      | Билл Гейтс        |
| 2      | Алан Тьюринг      |

Информация о заказах покупателей располагается в таблице `Заказы`, которая имеет следующий вид:

| **ID** | **ID покупателя** | **Стоимость** |
| ------ | ----------------- | ------------- |
| 1      | 2                 | 1500          |
| 2      | 1                 | 1000          |
| 3      | 2                 | 3500          |

Поле `ID` в обеих таблицах является первичным ключом. В таблице `Покупатели` оно представляет собой уникальный идентификатор покупателя, в таблице `Заказы` — уникальный идентификатор заказа.

Поскольку каждый заказ принадлежит определенному покупателю, в таблице `Заказы` присутствует поле `ID покупателя`, которое и определяет владельца заказа. В качестве значений этого поля используются идентификаторы покупателей, то есть значения поля `ID` таблицы `Покупатели`. Таким образом, поле `ID покупателя` является внешним ключом, которое вместе с первичным ключом таблицы `Покупатели` — полем `ID` — устанавливает связь между таблицами `Покупатели` и `Заказы`.

С помощью данной связи можно определить всю необходимую информацию о владельце любого заказа. Например, первый и третий заказы принадлежат Алану Тьюрингу, а второй — Биллу Гейтсу.
### Виды первичных и внешних ключей
Первичные и внешние ключи бывают нескольких видов. Первичные ключи разделяют в зависимости от того, какие именно данные используются для однозначного определения каждой записи таблицы, внешние же ключи разделяют в зависимости от того, на поле какой таблицы ссылается внешний ключ
#### Суррогатные и естественные ключи
Первичные ключи делятся на два вида: **суррогатные** и **естественные**.

Суррогатный ключ — это первичный ключ, созданный специально для идентификации записей таблицы, значения которого (часто числовые или символьные) не имеют прямого отношения к самим данным. Например, в рассмотренной ранее таблице `Заказы` поле `ID` является суррогатным ключом. Оно было специально создано для идентификации каждого заказа и не имеет прямого отношения к самому заказу.

Естественный ключ — это первичный ключ, значения которого непосредственно связаны с реальными данными или характеристиками хранимых сущностей. Например, в таблице, хранящей персональные данные людей, естественным ключом может выступать поле, содержащее номер паспорта человека или другого документа, скажем, водительских прав.

Первичный ключ, состоящий из одного поля, обычно называют **простым**. Если же первичный ключ включает несколько полей, его называют **составным**
#### Рекурсивные внешние ключи
Внешние ключи могут ссылаться на первичный ключ не только другой таблицы, но и той, в которой находится сам внешний ключ. Во втором случае внешний ключ называют **рекурсивным**. Рекурсивные внешние ключи используются для установления связей между разными записями в одной и той же таблице
В качестве примера использования рекурсивного внешнего ключа рассмотрим таблицу `Сотрудники`, которая хранит информацию о сотрудниках некоторой компании:

| **ID** | **Имя и фамилия** | **ID руководителя** |
| ------ | ----------------- | ------------------- |
| 1      | Билл Гейтс        | NULL                |
| 2      | Алан Тьюринг      | 1                   |
| 3      | Исаак Ньютон      | 1                   |
| 4      | Эдгар Кодд        | 2                   |

Поле `ID` этой таблицы является первичным ключом — уникальным идентификатором каждого сотрудника. Поле `ID руководителя` является внешним ключом и для каждого сотрудника определяет идентификатор его руководителя, который, в свою очередь, также является сотрудником и содержится в таблице `Сотрудники`. Следовательно, поле `ID руководителя` является рекурсивным внешним ключом, поскольку ссылается на первичный ключ той же таблицы, в которой находится сам.

Например, рекурсивный внешний ключ `ID руководителя` позволяет определить, что у Билла Гейтса нет руководителя. Также с его помощью можно выяснить, что руководителем Эдгара Кодда является Алан Тьюринг.
### [[Виды связей между таблицами]]
#### Соединение таблиц:
- [[Внутреннее соединение]] (`INNER JOIN`)
- [[Внешнее соединение]] (`LEFT OUTER JOIN` and `RIGHT OUTER JOIN`)
- [[Перекрестное соединение]] (`CRISS JOIN`)

![[Pasted image 20250113130104.png]]