#база_данных #реляционные #SQL #СУБД #агрегатные_функции #COUNT 

Функция `COUNT()` используется для подсчета количества записей в таблице или количества значений в поле. Для определения количества записей в таблице в функцию `COUNT()` в качестве аргумента необходимо передать звездочку `*`
```
+----+-------+-------------------------+------------+---------+--------------+--------+
| id | place | trackname               | artist     | streams | release_year | length |
+----+-------+-------------------------+------------+---------+--------------+--------+
| 1  | 4     | Crazy on You            | Heart      | 303885  | 1976         | 254    |
| 2  | 7     | My Lover                | The Sounds | 211133  | 2009         | 266    |
| 3  | 3     | Running up That Hill    | Kate Bush  | 339583  | NULL         | 296    |
| 4  | 5     | Thrill                  | The Sounds | 294264  | 2016         | 228    |
| 5  | 9     | Spent the Day in Bed    | Morrissey  | 174994  | 2017         | 259    |
| 6  | 2     | Bigmouth Strikes Again  | The Smiths | 379112  | 1986         | 195    |
| 7  | 6     | Painted By Numbers      | The Sounds | 265121  | 2006         | 200    |
| 8  | 8     | Let Me Kiss You         | Morrissey  | 197426  | 2004         | 210    |
| 9  | 1     | Keep Yourself Alive     | Queen      | 385991  | NULL         | 235    |
| 10 | 10    | Everyday is Like Sunday | Morrissey  | 160404  | 1988         | 216    |
+----+-------+-------------------------+------------+---------+--------------+--------+
```
---
```sql
SELECT COUNT(*) AS num_of_songs
FROM Songs;
```
```
+--------------+
| num_of_songs |
+--------------+
| 10           |
+--------------+
```

Аналогично функции `AVG()`, функция `COUNT()` может использоваться для подсчета количества записей, удовлетворяющих определенным условиям. К примеру, мы можем определить, сколько песен принадлежит исполнителю `Morrisey`.
```sql
SELECT COUNT(*) AS num_of_songs
FROM Songs
WHERE artist = 'Morrissey';
```
```
+--------------+
| num_of_songs |
+--------------+
| 3            |
+--------------+
```

Для определения количества значений в поле функции `COUNT()` в качестве аргумента необходимо передать это поле.
```sql
SELECT COUNT(trackname) AS num_of_tracknames
FROM Songs;
```
```
+-------------------+
| num_of_tracknames |
+-------------------+
| 10                |
+-------------------+
```

Важным отличием между вызовами `COUNT(*)` и `COUNT(<название поля>)` является то, что в первом случае возвращается количество записей в таблице без учета значений в этих записях, в то время как во втором случае возвращается количество значений в поле, причем значения `NULL` не учитываются.
```sql
SELECT COUNT(*) AS num_of_songs,
       COUNT(release_year) AS num_of_years
FROM Songs;
```
```
+--------------+--------------+
| num_of_songs | num_of_years |
+--------------+--------------+
| 10           | 8            |
+--------------+--------------+
```
### В `PostgreSQL` есть эта функция
Попробуем написать счетчик по условию, запрос, который будет определять количество рабочих и выходных дней в таблице:
```
+---------+---------+-------------+
| task_id | user_id | submit_date |
+---------+---------+-------------+
| 1       | 7       | 2023-01-10  |
| 2       | 2       | 2023-01-11  |
| 3       | 3       | 2023-01-15  |
| 4       | 4       | 2023-01-17  |
| 5       | 5       | 2023-01-20  |
| 6       | 4       | 2023-01-22  |
| 7       | 7       | 2023-01-23  |
| 8       | 6       | 2023-01-25  |
| 9       | 9       | 2023-01-28  |
| 10      | 2       | 2023-01-30  |
| 11      | 4       | 2023-02-02  |
| 12      | 4       | 2023-02-05  |
| 13      | 1       | 2023-02-08  |
| 14      | 5       | 2023-02-10  |
| 15      | 3       | 2023-02-13  |
| 16      | 4       | 2023-02-15  |
| 17      | 5       | 2023-02-18  |
| 18      | 1       | 2023-02-20  |
| 19      | 3       | 2023-02-23  |
| 20      | 4       | 2023-02-25  |
+---------+---------+-------------+
```
```MySQL
SELECT 
    COUNT(CASE WHEN weekday(submit_date) IN (5, 6) THEN 1 END) AS weekend_count, 
    COUNT(CASE WHEN weekday(submit_date) NOT IN (5, 6) THEN 1 END) AS working_count
FROM Actions
```
```
+---------------+---------------+
| weekend_count | working_count |
+---------------+---------------+
| 6             | 14            |
+---------------+---------------+
```